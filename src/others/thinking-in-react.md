---
title: React 思维
author: Randel Yuan
order: 1
tag:
 - React
 - 编程思维
---

这篇文章是我在学习[Thinking in React](https://react.dev/learn/thinking-in-react)的一些收获和思考。React 思维可以帮助开发者理解如何将复杂的UI设计分解为独立的、可复用的组件，以及如何通过props和state来处理数据和用户交互。
- 根据 React 思维来构建应用，可以让代码更加清晰、更易于维护，也使得应用的行为更加可预测。
- 学会从组件的角度来思考界面，而不是从页面或者视图的角度。每个组件都有其特定的任务和行为，同时也独立于其他组件。这意味着可以在不影响其他组件的情况下，更新每个组件。


## Step 1: 将 UI 拆解为组件层级结构

- 将应用划分成不同的组件。每个组件都应该有一个明确的职责，同时尽可能的复用，每个组件都包含它自己的逻辑。
- 可以将每一个组件看成一块拼图，每一块拼图都是独立的，有自己的形状和颜色，放在一起就构成了一个完整的图画。
- 例如，一个简单的网站可能包含 "头部" 组件，"导航栏" 组件，"主内容" 组件等等。

## Step 2: 创建静态版本

- 静态版本的目标是构建出一个不含有状态、不进行数据处理的页面，只是简单的渲染出 UI。
- 在React中，组件可以接收两种类型的数据：props 和 state。props 是从父组件传递给子组件的，而 state 是组件内部管理并可能改变的数据。
- 通常 props 是从API请求到的数据。而 state 是随时间变化和用户交互而改变的数据，例如：筛选后的列表。
- 在这一阶段，不需要考虑 state，只需要用 props 传递数据，并将其渲染到页面上。

## Step 3: 确定 state

- 在 React 中，state 是应用程序在某个时间点上的数据。通常 state 会随着时间变化和用户交互而改变。
- 设计 state 最重要的一条原则是保证它 Don't Repeat Yourself(DRY，不要自我重复)。
- 例如：搜索框中用户输入的搜索词、购物车中的商品都可能会变化，因此这些应该被定义为 state。

 ::: tip
 在 React 中，根据下列情况可以判定某条数据是不是 state
 - 随着时间推移，会变化
 - 不同通过props从父组件传递
 - 不基于已存在于组件中的 state 或者 props 进行计算
 :::

## Step 4: 确定哪些组件应该拥有 state

- 确定哪些组件拥有哪个 state 可以通过以下的步骤实现
  - 找到所有需要根据 state 渲染或者产生行为的组件
  - 寻找距离它们最近的共同父组件
  - 如果找不到合适的放置 state 的组件，可以创建一个仅用于保存 state 的新组件，并将其添加到公共父组件上层的某个位置
- 确定 state 应该被放置在哪：
  - 通常直接放置在距离它们最近的共同父组件
  - 也可以放置在父组件上层的组件

## Step 5: 反向数据流

- 一般情况下，在 React 中数据是单向流动的——从父组件到子组件。但是，有时候子组件需要更新父组件中的状态，这就需要使用反向数据流
- 通常会为子组件添加一些可以触发状态变化的事件处理器，如onClick，onChange等。当这些事件触发时，子组件会调用一个从父组件传递下来的函数(通常被称为回调函数)，并把需要更新的新值作为参数传递给这个函数。父组件接收到新值后，会更新自身的状态，然后重新渲染自己以及所有的子组件。
- 通过这种方式，React 能够确保数据的一致性，使得父组件和子组件能够同步地更新状态。

